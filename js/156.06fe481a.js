"use strict";(self["webpackChunkvue_crm"]=self["webpackChunkvue_crm"]||[]).push([[156],{8156:function(t,e,i){i.r(e),i.d(e,{default:function(){return u}});var s=function(){var t=this,e=t._self._c;return e("div",[e("div",{staticClass:"page-title"},[e("h3",[t._v("Планирование")]),e("h4",[t._v(t._s(t._f("currency")(t.info.bill,"RUB")))])]),t.loading?e("Loader"):t.categories.length?e("section",t._l(t.categories,(function(i){return e("div",{key:i.id},[e("p",[e("strong",[t._v(t._s(i.title)+":")]),t._v(" "+t._s(t._f("currency")(i.spend))+" из "+t._s(t._f("currency")(i.limit))+" ")]),e("div",{directives:[{name:"tooltip",rawName:"v-tooltip",value:i.tooltip,expression:"cat.tooltip"}],staticClass:"progress"},[e("div",{staticClass:"determinate",class:[i.progressColor],style:{width:i.progressPercent+"%"}})])])})),0):e("p",[t._v(" Категорий пока нет. "),e("br"),e("router-link",{attrs:{to:"/categories"}},[t._v("Добавить новую категорию")])],1)],1)},r=[],o=i(3822),n=i(379),a={name:"planning",metaInfo:{title:"Planning | VUE-CRM"},data:()=>({loading:!0,categories:[]}),computed:{...(0,o.Se)(["info"])},async mounted(){const t=await this.$store.dispatch("fetchRecords"),e=await this.$store.dispatch("fetchCategories");this.categories=e.map((e=>{const i=t.filter((t=>t.categoryId===e.id)).filter((t=>"outcome"===t.type)).reduce(((t,e)=>t+ +e.amount),0),s=100*i/e.limit,r=s>100?100:s,o=s<70?"green":s<100?"yellow":"red",a=e.limit-i,c=`${a<0?"Превышение на":"Осталось"} ${(0,n.Z)(Math.abs(a))}`;return{...e,progressPercent:r,progressColor:o,spend:i,tooltip:c}})),this.loading=!1}},c=a,l=i(1001),d=(0,l.Z)(c,s,r,!1,null,"41304594",null),u=d.exports}}]);
//# sourceMappingURL=156.06fe481a.js.map